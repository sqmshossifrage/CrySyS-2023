First inspect the `pcap` file, which includes a lot of USB packets. Using `Protocol Hierarchy`, we are able to find two HTTP packets. First look at them because they are in plaintext. It seems the user has retrived a `titok.jatekvezerlo.amgp` file. Extract and file and realize that it has something to do with the Xbox 360 controller. Searching `.amgp` online indicates it is a key mapping table between controller and keyboard, used by the [`AntiMicroX`](https://github.com/AntiMicroX/antimicrox) program. 

Look at the packets in detail. Packet No.46 indicates that port `2.25.1` is a G102 LIGHTSYNC Gaming Mouse. Similarly, we find that port `2.26.1` is a CK352 Mechanlcal Keyboard. 

By inspecting `Array` in `HID Data`, usually the first line shows the key being pressed on the keyboard. We know that the user has entered commands like `setxkbmap us`, `yay -S antimicrox`, and after downloading the `.amgp` file, the user issues commands like `antimicrox --tray --profile` and finally `ssh gyoker@10.85.1.142`. We all know what happens after that - the user has to enter the password. However, the user is using the device on port `2.27.1` to enter the password, which is the Xbox controller. Thus we filter out packets with the following Wireshark filter
```
usb.src == "2.27.1" and frame.number >= 5057 and frame.number <= 5179
```
and extract the field `Leftover Capture Data` from these packets. Now it's time to resolve the data. A search online reveals this article: [Understanding the Xbox 360 Wired Controllerâ€™s USB Data](https://www.partsnotincluded.com/understanding-the-xbox-360-wired-controllers-usb-data/) and the `Control Surface Data Format` section is of special interest. Now we can decode the user's interaction with the controller. For example, the user first pressed right stick downwards, then pressed the "down" on dpad, then pressed left stick downwards, and so on. After extracting a list of actions, we need to find a mapping from these actions to their corresponding keys on the keyboard. I searched online for `.amgp` mapping for Xbox 360 controller, but with no luck. It seems that the index of button depends on how the user configure the controller in `AntiMicroX`. Then I decided to decipher it myself. First we are able to determine the beginning `cd23{` and ending `}` of the flag. With these information, we can immediately determine that pressing the sticks (and dpad) upwards, downwards, left, and right correspond to the indices `1, 3, 5, 7` (and `1, 2, 4, 8` for dpad) in the `.amgp` file. Moreover, we know that LT corresponds to a `SHIFT` key on keyboard, and RT corresponds to a `U` key on keyboard. Now it ends the easy part and we have to guess which button corresponds to which index in the `.amgp` file. This can be done with guessing and trying to recover a meaningful sentence in the flag. I would not spoil the joy of deciphering. Tips: 
1. Finding which one corresponds to `_` can be helpful. 
2. Look at the [Buttons](https://www.partsnotincluded.com/understanding-the-xbox-360-wired-controllers-usb-data/) section, and there might be a loose relation between the indices and the diagram. 
3. Initially I had difficulties to recover a sentence, until I realized that one key corresponds to `backspace` on keyboard. In fact, the user used it when 
4. Near the end of the flag, the user pressed one key twice, like using a "switch". Think about it: which key functions like a switch?
5. There is a noisy signal near the end of the flag, identify where it is and ignore it. 
